program forallexample
  implicit none
  integer,parameter :: rk=selected_real_kind(10,40),N=10000
  integer :: a(N,N)
  integer :: i,j

  a=0
  forall (i=1:N:2,j=1:N:2,i+j>10)
     a(i,j)=(i+j)/2
  end forall

  print *
  print '(10i8)',a(1:N:1000,1:N:1000)
  print *

  stop
end program forallexample
